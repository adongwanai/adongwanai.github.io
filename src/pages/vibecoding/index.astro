---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const folderDisplayNames: Record<string, string> = {
  'foundation': 'ğŸ“š åŸºç¡€ä½“ç³»è¯¾ (Free)',
  'projects': 'ğŸš€ è¿›é˜¶å®æˆ˜é¡¹ç›® (Premium)',
  'Overview': 'ğŸ“Œ å…³äºæœ¬ç³»åˆ—'
};
const getFolderDisplayName = (f: string) => folderDisplayNames[f] || f;
const allNotes = (await getCollection('vibecoding')).sort(
  (a, b) => a.data.order - b.data.order
);

// Group notes by directory for the sidebar
const groupedNotes = allNotes.reduce((acc, currentNote) => {
  const parts = currentNote.slug.split('/');
  const folder = parts.length > 1 ? parts.slice(0, -1).join('/') : 'Overview';
  
  if (!acc[folder]) acc[folder] = [];
  acc[folder].push(currentNote);
  return acc;
}, {} as Record<string, typeof allNotes>);

---

<Layout title="é˜¿ä¸œçš„ VibeCoding èµšé’±ç¬”è®°">
  <div class="pt-[90px] pb-24 px-4 sm:px-6 lg:px-8 max-w-[1440px] mx-auto flex flex-col md:flex-row gap-8">
    
    <!-- Left Sidebar (Menu) -->
    <aside class="hidden md:block w-64 lg:w-72 shrink-0">
      <div class="sticky top-[90px] h-[calc(100vh-[90px])] overflow-y-auto pr-4 pb-12 custom-scrollbar border-r border-gray-200 dark:border-white/10">
        <div class="mb-6">
           <a href="/vibecoding" class="text-sm font-bold text-blue-600 dark:text-blue-400 flex items-center gap-2 transition-colors">
             ğŸ“š èµšé’±ç¬”è®°é¦–é¡µ
           </a>
        </div>
        
        <div class="flex flex-col gap-6">
          {Object.entries(groupedNotes).map(([folder, folderNotes]) => (
            <div class="flex flex-col gap-2">
               {folder !== 'Overview' && (
                 <h3 class="font-bold text-gray-900 dark:text-gray-100 text-sm mb-1">{getFolderDisplayName(folder)}</h3>
               )}
               <nav class="flex flex-col gap-[2px] border-l border-gray-200 dark:border-white/10 ml-2 pl-3">
                {folderNotes.map((item) => (
                  <a 
                    href={`/vibecoding/${item.slug}`} 
                    class="block py-1.5 px-3 rounded-md text-sm transition-all duration-200 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-white/5 hover:text-gray-900 dark:hover:text-white"
                  >
                    {item.data.title}
                  </a>
                ))}
               </nav>
            </div>
          ))}
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 min-w-0 lg:px-8 mt-4 md:mt-0">
      <div class="mb-12">
        <div class="inline-flex items-center gap-2 px-3 py-1 bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-full text-xs text-accent mb-6 font-semibold uppercase tracking-wider">
          <span>ğŸ“š</span>
          <span>Vibe Coding èµšé’±ç¬”è®°</span>
        </div>
        <h1 class="text-4xl md:text-5xl font-extrabold mb-6 text-gray-900 dark:text-white tracking-tight">Vibe Coding ä¸“æ åº“</h1>
        <p class="text-gray-600 dark:text-gray-400 text-lg max-w-2xl leading-relaxed">
          å…¨ç½‘ç¨€ç¼ºçš„ <span class="text-gray-900 dark:text-gray-100 font-bold">AI Native ç¼–ç¨‹å®æˆ˜å®å…¸</span>ã€‚å¸¦ä½ æ·±åº¦æŒæ¡ Cursorã€Claude Code ä¸ Skills æ ¸å¿ƒå·¥ä½œæµï¼Œå®Œæˆä»åˆçº§ç¼–ç åˆ°æ— æ‰€ä¸èƒ½<span class="text-accent">è¶…çº§ä¸ªä½“</span>çš„æ€ç»´å¤§è·ƒè¿ã€‚
        </p>
      </div>

      <!-- Learning Paths -->
      <div class="grid md:grid-cols-2 gap-6 mb-12">
        <!-- Foundation Path -->
        <a href="/vibecoding/foundation" class="group block">
          <div class="bg-gradient-to-br from-blue-50 to-violet-50 dark:from-blue-900/20 dark:to-violet-900/20 border-2 border-blue-200 dark:border-blue-500/20 rounded-xl p-8 hover:border-blue-400 dark:hover:border-blue-400 transition-all h-full relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-blue-500/0 to-violet-500/0 group-hover:from-blue-500/5 group-hover:to-violet-500/5 transition-opacity"></div>
            <div class="relative z-10">
              <div class="flex items-center gap-2 mb-4">
                <span class="px-3 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full text-sm font-semibold">
                  âœ“ 100% å…è´¹
                </span>
              </div>
              <div class="text-5xl mb-4">ğŸ“–</div>
              <h3 class="text-2xl font-bold mb-3 text-gray-900 dark:text-gray-100">åŸºç¡€è¯¾ç¨‹</h3>
              <p class="text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
                æŒæ¡å·¥å…·é…ç½®ã€æ ¸å¿ƒå·¥ä½œæµå’Œæœ€ä½³å®è·µ
              </p>
              <ul class="space-y-2 mb-6 text-sm text-gray-600 dark:text-gray-400">
                <li class="flex items-center gap-2">
                  <span class="text-green-500">âœ“</span>
                  <span>Cursor & Claude Code é…ç½®</span>
                </li>
                <li class="flex items-center gap-2">
                  <span class="text-green-500">âœ“</span>
                  <span>MCP åè®®åŸºç¡€</span>
                </li>
                <li class="flex items-center gap-2">
                  <span class="text-green-500">âœ“</span>
                  <span>Prompt Engineering</span>
                </li>
              </ul>
              <div class="flex items-center text-blue-600 dark:text-blue-400 font-semibold group-hover:text-blue-700 transition-colors">
                <span>å¼€å§‹å…è´¹å­¦ä¹ </span>
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </div>
            </div>
          </div>
        </a>

        <!-- Projects Path -->
        <a href="/vibecoding/projects" class="group block">
          <div class="bg-gradient-to-br from-violet-50 to-blue-50 dark:from-violet-900/20 dark:to-blue-900/20 border-2 border-violet-200 dark:border-violet-500/20 rounded-xl p-8 hover:border-violet-400 dark:hover:border-violet-400 transition-all h-full relative overflow-hidden">
            <div class="absolute top-6 right-6 bg-violet-100 dark:bg-violet-900/30 text-violet-700 dark:text-violet-400 px-3 py-1 rounded-full text-sm font-bold uppercase tracking-wider">
              Premium
            </div>
            <div class="absolute inset-0 bg-gradient-to-br from-violet-500/0 to-blue-500/0 group-hover:from-violet-500/5 group-hover:to-blue-500/5 transition-opacity"></div>
            <div class="relative z-10">
              <div class="text-5xl mb-4">ğŸš€</div>
              <h3 class="text-2xl font-bold mb-3 text-gray-900 dark:text-gray-100">é¡¹ç›®å®æˆ˜</h3>
              <p class="text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
                é€šè¿‡çœŸå®é¡¹ç›®å­¦ä¹ ï¼Œæ„å»ºç”Ÿäº§çº§ AI åº”ç”¨
              </p>
              <ul class="space-y-2 mb-6 text-sm text-gray-600 dark:text-gray-400">
                <li class="flex items-center gap-2">
                  <span>ğŸ¯</span>
                  <span>9 å¤§å®æˆ˜é¡¹ç›®çŸ©é˜µ</span>
                </li>
                <li class="flex items-center gap-2">
                  <span>ğŸ’»</span>
                  <span>å®Œæ•´æºä»£ç  + è§†é¢‘æ•™ç¨‹</span>
                </li>
                <li class="flex items-center gap-2">
                  <span>ğŸ’¬</span>
                  <span>ç¤¾åŒºç­”ç–‘æ”¯æŒ</span>
                </li>
              </ul>
              <div class="flex items-center text-violet-600 dark:text-violet-400 font-semibold group-hover:text-violet-700 transition-colors">
                <span>æŸ¥çœ‹é¡¹ç›®æ•™ç¨‹</span>
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- Divider -->
      <div class="flex items-center gap-4 mt-16 mb-8">
        <div class="flex-1 h-px bg-gray-200 dark:bg-white/10"></div>
        <span class="text-sm text-gray-500 dark:text-gray-400 font-medium px-4">ç¬¬ä¸€é˜¶æ®µï¼šå¿ƒæµè§‰é†’ (å¼€æºå…è´¹)</span>
        <div class="flex-1 h-px bg-gray-200 dark:bg-white/10"></div>
      </div>

      <!-- Foundation Resources -->
      <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-16">
        {allNotes.filter(note => note.slug.startsWith('foundation/')).map((note) => (
          <a href={`/vibecoding/${note.slug}`} class="group block">
            <div class="bg-white dark:bg-[#1a1c23] border border-gray-200 dark:border-white/10 rounded-xl p-6 h-full hover:border-blue-400/50 dark:hover:border-blue-400/40 hover:shadow-[0_4px_20px_-4px_rgba(59,130,246,0.1)] transition-all duration-300 relative overflow-hidden flex flex-col justify-between">
               <div class="absolute inset-0 bg-gradient-to-br from-blue-500/5 to-violet-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
               <div>
                 <h3 class="text-lg font-bold mb-3 text-gray-900 dark:text-gray-100 group-hover:text-blue-500 dark:group-hover:text-blue-400 relative z-10 flex justify-between items-center transition-colors">
                   {note.data.title}
                 </h3>
                 <p class="text-gray-500 dark:text-gray-400 text-sm leading-relaxed relative z-10 line-clamp-2">
                   {note.data.description}
                 </p>
               </div>
               <div class="mt-4 flex items-center text-xs font-semibold text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity transform -translate-x-2 group-hover:translate-x-0">
                 å¼€å§‹å­¦ä¹  <span class="text-lg ml-1 leading-none">â†’</span>
               </div>
            </div>
          </a>
        ))}
      </div>

      <!-- Divider -->
      <div class="flex items-center gap-4 mb-8">
        <div class="flex-1 h-px bg-gray-200 dark:bg-white/10"></div>
        <span class="text-sm text-gray-500 dark:text-gray-400 font-medium px-4">ç¬¬äºŒé˜¶æ®µï¼šè¶…çº§ä¸ªä½“å®æˆ˜ (æ˜Ÿçƒä¸“å±)</span>
        <div class="flex-1 h-px bg-gray-200 dark:bg-white/10"></div>
      </div>

      <!-- Projects Resources -->
      <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
        {allNotes.filter(note => note.slug.startsWith('projects/')).map((note) => (
          <a href={`/vibecoding/${note.slug}`} class="group block">
            <div class="bg-violet-50/50 dark:bg-[#1f1a24] border border-violet-100 dark:border-violet-500/10 rounded-xl p-6 h-full hover:border-violet-400/50 dark:hover:border-violet-400/40 hover:shadow-[0_4px_20px_-4px_rgba(139,92,246,0.15)] transition-all duration-300 relative overflow-hidden flex flex-col justify-between">
               <div class="absolute top-6 right-6 text-violet-400 opacity-50 group-hover:opacity-100 transition-opacity">ğŸ”’</div>
               <div class="absolute inset-0 bg-gradient-to-br from-violet-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
               <div>
                 <h3 class="text-lg font-bold mb-3 text-gray-900 dark:text-gray-100 group-hover:text-violet-600 dark:group-hover:text-violet-400 relative z-10 flex items-center gap-2 transition-colors pr-6">
                   {note.data.title}
                 </h3>
                 <p class="text-gray-500 dark:text-gray-400 text-sm leading-relaxed relative z-10 line-clamp-2">
                   {note.data.description}
                 </p>
               </div>
               <div class="mt-4 flex items-center text-xs font-semibold text-violet-600 dark:text-violet-400 opacity-0 group-hover:opacity-100 transition-opacity transform -translate-x-2 group-hover:translate-x-0">
                 è§£é”å®æˆ˜é¡¹ç›® <span class="text-lg ml-1 leading-none">â†’</span>
               </div>
            </div>
          </a>
        ))}
      </div>
    </main>

  </div>
</Layout>

<style>
  .custom-scrollbar::-webkit-scrollbar {
    width: 4px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: rgba(156, 163, 175, 0.3);
    border-radius: 20px;
  }
  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.1);
  }
  .custom-scrollbar:hover::-webkit-scrollbar-thumb {
    background-color: rgba(156, 163, 175, 0.5);
  }
</style>
